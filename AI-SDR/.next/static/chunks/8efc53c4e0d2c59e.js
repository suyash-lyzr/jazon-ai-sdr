(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19472,e=>{"use strict";e.s(["default",()=>G],19472);var s=e.i(43476),a=e.i(71645),t=e.i(22931),i=e.i(30909),n=e.i(15288),r=e.i(87486),l=e.i(19455),c=e.i(68148),d=e.i(67489),o=e.i(76639),m=e.i(80376),h=e.i(77572),x=e.i(24687),u=e.i(93479),p=e.i(10204),g=e.i(29592),j=e.i(17394),v=e.i(51305),f=e.i(63488),N=e.i(43432),b=e.i(86311),y=e.i(98919),w=e.i(95468),C=e.i(3116),_=e.i(75254);let S=(0,_.default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]);var k=e.i(18724),T=e.i(19909),A=e.i(82293),E=e.i(63209),I=e.i(25652),O=e.i(20278);let L=(0,_.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var P=e.i(39312),B=e.i(58041),z=e.i(55436);let M=(0,_.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var D=e.i(86536),F=e.i(78583),H=e.i(64659),V=e.i(55900),R=e.i(83627),q=e.i(31278);let U=(0,_.default)("linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);function G(){var e,_,G,Q,J,W,K,Y,Z,$,X,ee,es,ea,et,ei,en,er,el,ec,ed,eo;let{leads:em}=(0,v.useJazonApp)(),[eh,ex]=(0,a.useState)(null),[eu,ep]=(0,a.useState)(null),[eg,ej]=(0,a.useState)(!1),[ev,ef]=(0,a.useState)(null),[eN,eb]=(0,a.useState)(""),[ey,ew]=(0,a.useState)("executive"),[eC,e_]=(0,a.useState)(new Set),[eS,ek]=(0,a.useState)([]),[eT,eA]=(0,a.useState)(null),[eE,eI]=(0,a.useState)(!1),[eO,eL]=(0,a.useState)(!1),[eP,eB]=(0,a.useState)({open:!1,section:null}),[ez,eM]=(0,a.useState)({}),[eD,eF]=(0,a.useState)(!1),[eH,eV]=(0,a.useState)(!1),[eR,eq]=(0,a.useState)(null),[eU,eG]=(0,a.useState)(!1),[eQ,eJ]=(0,a.useState)(null),eW=e=>{if(!e)return"";let s="string"==typeof e?new Date(e):e;if(isNaN(s.getTime()))return"";new Date().getTime(),s.getTime();if(!s)return"";let a="string"==typeof s?new Date(s):s;return isNaN(a.getTime())?"":a.toISOString().split("T")[0]};(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/leads"),s=await e.json();if(s.success&&s.leads){let e=s.leads.map(e=>{var s,a;return{id:e._id,name:e.name,company:(null==(s=e.company)?void 0:s.name)||"Unknown",icpScore:(null==(a=e.icp_score)?void 0:a.icp_score)||0,stage:"icp_scored"===e.status?"Qualification":"Research",_dbLead:e}});ek(e)}}catch(e){console.error("Error fetching leads:",e)}})()},[]);let eK=(0,a.useMemo)(()=>[...em.map(e=>({...e,_dbLead:null})),...eS],[em,eS]),eY=(0,a.useMemo)(()=>0===eK.length?null:eK.find(e=>"Qualification"===e.stage||"Engaged"===e.stage)||eK[0],[eK]),eZ=eh&&eK.find(e=>e.id===eh)||eY;(0,a.useEffect)(()=>{(async()=>{if(!eZ||!eZ._dbLead)return eA(null);eI(!0);try{let e=await fetch("/api/leads/".concat(eZ.id,"/outreach")),s=await e.json();s.success&&eA(s.data)}catch(e){console.error("Error fetching outreach data:",e)}finally{eI(!1)}})()},[null==eZ?void 0:eZ.id]);let e$=(null==eT?void 0:eT.strategy)||(null===j.mockOutreachStrategies||void 0===j.mockOutreachStrategies?void 0:j.mockOutreachStrategies[0])||{channelStrategy:[],guardrails:{maxTouches:8,voiceEscalationAllowed:!0,voiceEscalationTrigger:"",stopConditions:[]}},eX=eZ&&j.mockConversations[eZ.id]||[],e0=async()=>{if(!eZ||!eZ._dbLead)return void alert("Please select a database lead to generate outreach");eL(!0);try{let e=await fetch("/api/leads/".concat(eZ.id,"/outreach/generate"),{method:"POST",headers:{"Content-Type":"application/json"}}),s=await e.json();if(s.success){let e=await fetch("/api/leads/".concat(eZ.id,"/outreach")),s=await e.json();s.success&&eA(s.data),ep("Outreach strategy and copy generated successfully")}else alert("Error: ".concat(s.error||"Failed to generate outreach"))}catch(e){console.error("Error generating outreach:",e),alert("Failed to generate outreach")}finally{eL(!1)}},e2=async e=>{if(eZ&&eZ._dbLead){ej(!0),ep("Logging ".concat(e," for audit purposes…"));try{let s=await fetch("/api/leads/".concat(eZ.id,"/outreach/control"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,reason:eN})}),a=await s.json();if(a.success){let e=await fetch("/api/leads/".concat(eZ.id,"/outreach")),s=await e.json();s.success&&eA(s.data),ep(a.message),ef(null),eb("")}else alert("Error: ".concat(a.error||"Failed to execute control action"))}catch(e){console.error("Error executing control action:",e),alert("Failed to execute control action")}finally{ej(!1)}}},e4=eZ?(null==eT?void 0:eT.campaign)?"not_started"===eT.campaign.status?"research":eT.campaign.status:"Disqualified"===eZ.stage?"stopped":"Meeting Scheduled"===eZ.stage?"completed":"Qualification"===eZ.stage||"Engaged"===eZ.stage?"active":"research":"no_lead",e1=(0,a.useMemo)(()=>{if(!eZ)return[];if((null==eT?void 0:eT.events)&&eT.events.length>0)return eT.events;let e=[],s=1;return e.push({id:"".concat(eZ.id,"-ingestion"),eventType:"lifecycle",timestamp:eZ.ingestedAt||"7 days ago",sortOrder:s++,actor:"System",title:"Lead ingested from ".concat(eZ.source||"Unknown source"),description:eZ.originTrigger||"Lead entered Jazon via ".concat(eZ.source,". Initial data sync completed."),metadata:{source:eZ.source,importedBy:eZ.importedBy,workspace:"Production Workspace"},badge:"Lead Ingestion"}),e.push({id:"".concat(eZ.id,"-research"),eventType:"research",timestamp:"6 days ago",sortOrder:s++,actor:"AI",title:"ICP analysis completed",description:"Lead evaluated with ICP score ".concat(eZ.icpScore,". ").concat(eZ.icpScore>=85?"High fit":eZ.icpScore>=70?"Medium fit":"Low fit"," determined based on company size, industry, tech stack, and persona."),metadata:{icpScore:eZ.icpScore,fitCategory:eZ.icpScore>=85?"High":eZ.icpScore>=70?"Medium":"Low",dataSources:["LinkedIn","CRM","Perplexity"],confidence:eZ.icpScore>=70?"High":"Medium"},badge:"AI Research"}),eZ.triggers&&eZ.triggers.length>0&&e.push({id:"".concat(eZ.id,"-triggers"),eventType:"research",timestamp:"6 days ago",sortOrder:s++,actor:"AI",title:"".concat(eZ.triggers.length," buying signal(s) detected"),description:eZ.triggers.join(". ")+".",metadata:{triggerCount:eZ.triggers.length,signals:eZ.triggers},badge:"Trigger Detection"}),"Research"!==eZ.stage&&("Disqualified"!==eZ.stage||eZ.icpScore>=60)&&(e.push({id:"".concat(eZ.id,"-outreach-start"),eventType:"outreach",timestamp:"5 days ago",sortOrder:s++,actor:"AI",title:"Outreach strategy initiated",description:"Multi-channel sequence started based on ICP score ".concat(eZ.icpScore,". Initial channel: Email. Strategy includes up to 8 touches across Email, LinkedIn, and conditional Voice."),metadata:{channelStrategy:["Email","LinkedIn","Voice"],icpScore:eZ.icpScore,complianceChecks:["GDPR","CAN-SPAM","Business hours"]},badge:"Outreach Start"}),eX.forEach(a=>{e.push({id:a.id,eventType:"outbound"===a.direction?"outreach":"engagement",timestamp:a.timestamp,sortOrder:s++,actor:"outbound"===a.direction?"AI":"Human",title:a.subject||"".concat(a.channel," ").concat(a.direction),description:a.summary||a.content||"".concat(a.channel," message ").concat(a.direction),metadata:{channel:a.channel,direction:a.direction,outcome:a.outcome,duration:a.duration,aiGenerated:"outbound"===a.direction},badge:"outbound"===a.direction?"Outreach Action":"Engagement Event"})})),("Engaged"===eZ.stage||"Qualification"===eZ.stage)&&e.push({id:"".concat(eZ.id,"-compliance-check"),eventType:"guardrail",timestamp:"3 days ago",sortOrder:s++,actor:"System",title:"Weekend outreach blocked",description:"Scheduled email deferred to Monday to respect business hours compliance rule.",metadata:{guardrailName:"No weekend outreach",triggerCondition:"Saturday send scheduled",actionTaken:"Deferred to Monday 9:00 AM",systemConfirmation:"Compliance rule enforced"},badge:"Compliance"}),"Qualification"===eZ.stage&&eZ.channel&&eZ.channel.includes("Voice")&&e.push({id:"".concat(eZ.id,"-voice-escalation"),eventType:"decision",timestamp:"2 hours ago",sortOrder:s++,actor:"AI",title:"Voice escalation approved",description:"High engagement on previous channels + ICP score ".concat(eZ.icpScore," warranted personal touch. Voice escalation guardrails passed."),metadata:{icpScore:eZ.icpScore,rulesTriggered:["ICP ≥ 80","Engagement on 2+ channels"],rulesPassed:["Max touches not exceeded","Voice escalation allowed"],humanApprovalRequired:!1,confidence:"High"},badge:"AI Decision"}),"Meeting Scheduled"===eZ.stage&&(e.push({id:"".concat(eZ.id,"-meeting"),eventType:"outcome",timestamp:"1 hour ago",sortOrder:s++,actor:"AI",title:"Meeting booked",description:"Lead fully qualified via BANT analysis. Meeting scheduled and calendar invite sent.",metadata:{qualificationScore:88,bantConfirmed:["Need","Timeline","Authority","Budget"]},badge:"Outcome"}),e.push({id:"".concat(eZ.id,"-handoff"),eventType:"outcome",timestamp:"1 hour ago",sortOrder:s++,actor:"System",title:"AE handoff completed",description:"Handoff pack prepared with research summary, qualification notes, objections, and talk track. CRM updated.",metadata:{crmUpdated:!0,handoffPackGenerated:!0},badge:"Outcome"})),"Disqualified"===eZ.stage&&(e.push({id:"".concat(eZ.id,"-disqualify"),eventType:"decision",timestamp:"1 week ago",sortOrder:s++,actor:"AI",title:"Lead disqualified",description:"ICP score ".concat(eZ.icpScore," below threshold (60). Wrong market segment. Outreach stopped to save AE time."),metadata:{icpScore:eZ.icpScore,reason:"ICP mismatch",confidence:"High",rulesTriggered:["ICP < 60"]},badge:"AI Decision"}),e.push({id:"".concat(eZ.id,"-stop"),eventType:"outcome",timestamp:"1 week ago",sortOrder:s++,actor:"System",title:"Outreach stopped",description:"All scheduled actions cancelled. Lead moved to disqualified status. CRM updated.",metadata:{crmUpdated:!0,outreachStopped:!0},badge:"Outcome"})),e.sort((e,s)=>e.sortOrder-s.sortOrder)},[eZ,eX,eT]),e3=(0,a.useMemo)(()=>e1&&Array.isArray(e1)?e1.filter(e=>{var s,a;return"outcome"===e.eventType||"decision"===e.eventType||"outreach"===e.eventType&&(null==(s=e.metadata)?void 0:s.channel)==="voice"||"engagement"===e.eventType&&(null==(a=e.metadata)?void 0:a.direction)==="inbound"}):[],[e1]);return(0,s.jsxs)(i.SidebarProvider,{style:{"--sidebar-width":"calc(var(--spacing) * 60)","--header-height":"calc(var(--spacing) * 12)"},children:[(0,s.jsx)(t.JazonSidebar,{variant:"inset"}),(0,s.jsx)(i.SidebarInset,{children:(0,s.jsx)("div",{className:"flex flex-1 flex-col",children:(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-6 p-4 md:gap-8 md:p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("h1",{className:"text-3xl font-semibold text-foreground",children:"Outreach Campaign"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Strategic, multi-channel engagement - not email blasting"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[eZ&&eZ._dbLead&&(0,s.jsx)(l.Button,{onClick:e0,disabled:eO,className:"gap-2",size:"sm",children:eO?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(q.Loader2,{className:"h-4 w-4 animate-spin"}),"Generating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.Zap,{className:"h-4 w-4"}),(null==eT?void 0:eT.strategy)?"Regenerate":"Generate"," ","Outreach"]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0 max-w-md",children:[(0,s.jsx)("label",{className:"text-xs text-muted-foreground shrink-0",children:"Lead:"}),(0,s.jsxs)(d.Select,{value:eh||(null==eY?void 0:eY.id)||"",onValueChange:ex,children:[(0,s.jsx)(d.SelectTrigger,{className:"w-full",children:(0,s.jsx)(d.SelectValue,{placeholder:"Choose a lead"})}),(0,s.jsx)(d.SelectContent,{children:eK.map(e=>(0,s.jsx)(d.SelectItem,{value:e.id,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:e.name}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:["• ",e.company]}),(0,s.jsxs)(r.Badge,{variant:"outline",className:"ml-auto text-xs",children:["ICP ",e.icpScore]}),(0,s.jsx)(r.Badge,{variant:"secondary",className:"text-xs",children:e.stage})]})},e.id))})]})]})]})]}),eZ&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-muted/30 rounded-xl p-5 border border-border/50",children:(0,s.jsxs)("div",{className:"grid grid-cols-5 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Outreach Status"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["active"===e4&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),(0,s.jsx)(r.Badge,{variant:"default",children:"Active"})]}),"completed"===e4&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2"}),(0,s.jsx)(r.Badge,{className:"bg-chart-2 hover:bg-chart-2",children:"Completed"})]}),"stopped"===e4&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T.StopCircle,{className:"w-4 h-4 text-destructive"}),(0,s.jsx)(r.Badge,{variant:"outline",className:"text-destructive border-destructive",children:"Stopped"})]}),"research"===e4&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.Clock,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)(r.Badge,{variant:"outline",children:"Research"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Current Phase"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:eZ?(null==eT?void 0:eT.campaign)?eT.campaign.current_phase:"Research"===eZ.stage?"Research":"Engaged"===eZ.stage?"Engagement":"Qualification"===eZ.stage?"Qualification":"Meeting Scheduled"===eZ.stage?"Handoff":"Research":"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Last Action"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:(null==eT?void 0:eT.events)&&eT.events.length>0?"".concat(eT.events[eT.events.length-1].title," - ").concat(eW(eT.events[eT.events.length-1].timestamp)):"active"===e4?"Voice call - 2 hours ago":"completed"===e4?"AE handoff - 1 hour ago":eZ.lastContact})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Next Planned Action"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:(null==eT||null==(_=eT.campaign)||null==(e=_.next_planned_action)?void 0:e.label)?"".concat(eT.campaign.next_planned_action.label).concat(eT.campaign.next_planned_action.scheduled_at?" - ".concat(eW(eT.campaign.next_planned_action.scheduled_at)):""):"active"===e4&&"Qualification"===eZ.stage?"Follow-up email - tomorrow":"completed"===e4?"AE handoff complete":"stopped"===e4?"None - outreach stopped":"Generate outreach strategy"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Final AI Decision"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:eZ?(null==eT||null==(eo=eT.campaign)?void 0:eo.final_decision)?"".concat(eT.campaign.final_decision.status).concat(eT.campaign.final_decision.reason?" → ".concat(eT.campaign.final_decision.reason):""):"Meeting Scheduled"===eZ.stage?"Qualified → AE handoff":"Disqualified"===eZ.stage?"Disqualified → ICP mismatch":"Qualification"===eZ.stage?"In progress":"Engaged"===eZ.stage?"Nurturing → Qualification":"Research in progress":"-"})]})]})}),"completed"===e4&&(0,s.jsx)(n.Card,{className:"border-chart-2/30 bg-chart-2/10",children:(0,s.jsx)(n.CardContent,{className:"py-6",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:"p-3 rounded-lg bg-chart-2/20",children:(0,s.jsx)(w.CheckCircle2,{className:"w-6 h-6 text-chart-2"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Outreach Successfully Completed"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Meeting scheduled and AE handoff completed. Outreach strategy achieved its goal."}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-background/50 rounded-lg p-3 border border-border/30",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Why it worked"}),(0,s.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-chart-2",children:"•"}),(0,s.jsxs)("span",{children:["High ICP score (",eZ.icpScore,")"]})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-chart-2",children:"•"}),(0,s.jsx)("span",{children:"Strong engagement across multiple channels"})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-chart-2",children:"•"}),(0,s.jsx)("span",{children:"Active buying signals detected"})]})]})]}),(0,s.jsxs)("div",{className:"bg-background/50 rounded-lg p-3 border border-border/30",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Outcome"}),(0,s.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2 mt-0.5"}),(0,s.jsx)("span",{children:"Meeting booked"})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2 mt-0.5"}),(0,s.jsx)("span",{children:"AE handoff pack prepared"})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2 mt-0.5"}),(0,s.jsx)("span",{children:"CRM updated (demo)"})]})]})]})]})]})]})})}),"stopped"===e4&&(0,s.jsx)(n.Card,{className:"border-destructive/30 bg-destructive/5",children:(0,s.jsx)(n.CardContent,{className:"py-6",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:"p-3 rounded-lg bg-destructive/10",children:(0,s.jsx)(T.StopCircle,{className:"w-6 h-6 text-destructive"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Outreach Disabled"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"This lead was disqualified and outreach has been automatically stopped."}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-background/50 rounded-lg p-3 border border-border/30",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Disqualification Reason"}),(0,s.jsxs)("p",{className:"text-sm mb-2",children:["Low ICP score (",eZ.icpScore,") - wrong market segment"]}),(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:"High Confidence"})]}),(0,s.jsxs)("div",{className:"bg-background/50 rounded-lg p-3 border border-border/30",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Value Saved"}),(0,s.jsx)("p",{className:"text-sm mb-2",children:"Early disqualification prevented wasted AE time"}),(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:"AI Decision (Automatic)"})]})]})]})]})})}),("active"===e4||(null==eT?void 0:eT.strategy))&&(0,s.jsxs)(n.Card,{children:[(0,s.jsxs)(n.CardHeader,{className:"relative pr-20",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(n.CardTitle,{children:"AI-Generated Outreach Strategy for This Lead"}),(0,s.jsx)(n.CardDescription,{children:(null==eT||null==(G=eT.strategy)?void 0:G.plan_summary)||"Intelligent channel escalation based on ICP score (".concat(eZ.icpScore,") and engagement signals from Research & ICP")})]}),(null==eT?void 0:eT.strategy)&&(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{let e=eT.strategy.recommended_channel_sequence||[];eM({plan_summary:eT.strategy.plan_summary||"",steps:e.map(e=>({step:e.step,channel:e.channel,goal:e.goal||"",reasoning:e.reasoning||"",recommended_delay_hours:e.recommended_delay_hours||0,send_window:e.send_window||"",personalization_signals:(e.personalization_signals||[]).join("\n"),gating_conditions:(e.gating_conditions||[]).join("\n")}))}),eB({open:!0,section:"strategy"})},className:"absolute top-4 right-4 h-6 px-2 gap-1.5 text-xs",children:[(0,s.jsx)(R.Edit3,{className:"h-3 w-3"}),"Edit"]})]}),(0,s.jsx)(n.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Strategy Progress"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Step"," ",(null==eT||null==(Q=eT.campaign)?void 0:Q.current_step_number)||e$.currentStep||0," ","of"," ",(null==eT||null==(W=eT.strategy)||null==(J=W.recommended_channel_sequence)?void 0:J.length)||e$.totalSteps||0]})]}),(0,s.jsx)(c.Progress,{value:((null==eT||null==(K=eT.campaign)?void 0:K.current_step_number)||e$.currentStep)/((null==eT||null==(Z=eT.strategy)||null==(Y=Z.recommended_channel_sequence)?void 0:Y.length)||e$.totalSteps)*100,className:"h-2"}),(0,s.jsx)("div",{className:"flex items-center gap-2 mt-2",children:Array.from({length:(null==eT||null==(X=eT.strategy)||null==($=X.recommended_channel_sequence)?void 0:$.length)||e$.totalSteps}).map((e,a)=>{var t,i;return(0,s.jsx)("div",{className:"flex-1 h-1 rounded-full ".concat(a<((null==eT||null==(t=eT.campaign)?void 0:t.current_step_number)||e$.currentStep)?"bg-chart-2":a===((null==eT||null==(i=eT.campaign)?void 0:i.current_step_number)||e$.currentStep)?"bg-primary":"bg-muted")},a)})})]}),(0,s.jsx)("div",{className:"space-y-4",children:((null==eT||null==(ee=eT.strategy)?void 0:ee.recommended_channel_sequence)||(null==e$?void 0:e$.channelStrategy)||[]).map((e,a)=>{var t,i,n,c;let d=(null==eT||null==(t=eT.campaign)?void 0:t.current_step_number)>e.step?"completed":(null==eT||null==(i=eT.campaign)?void 0:i.current_step_number)===e.step?"active":"pending",o=e.status||d;return(0,s.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,s.jsxs)("div",{className:"p-3 rounded-lg shrink-0 ".concat("completed"===o?"bg-chart-2/10 text-chart-2":"active"===o?"bg-primary/10 text-primary":"bg-muted/50 text-muted-foreground"),children:["Email"===e.channel&&(0,s.jsx)(f.Mail,{className:"w-5 h-5"}),"LinkedIn"===e.channel&&(0,s.jsx)(b.MessageSquare,{className:"w-5 h-5"}),"Voice"===e.channel&&(0,s.jsx)(N.Phone,{className:"w-5 h-5"})]}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h3",{className:"font-semibold",children:e.channel}),(0,s.jsxs)(r.Badge,{variant:"outline",className:"text-xs",children:["Step ",e.step]}),"completed"===o&&(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2"}),"active"===o&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-primary",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"In Progress"})]}),"pending"===o&&(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:"Upcoming"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.goal}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>{var s;let a=((null==eT||null==(s=eT.copy)?void 0:s.drafts)||[]).find(s=>s.step===e.step||String(s.step)===String(e.step)&&s.channel===e.channel);eq(a||{step:e.step,channel:e.channel,_missing:!0}),eJ(a?{...a}:null),eG(!1),eV(!0)},className:"gap-2 mt-2",disabled:!(null==eT||null==(c=eT.copy)||null==(n=c.drafts)?void 0:n.some(s=>s.step===e.step||String(s.step)===String(e.step))),children:[(0,s.jsx)(F.FileText,{className:"w-4 h-4"}),"View AI-Generated Copy"]}),e.reasoning&&(0,s.jsxs)("div",{className:"bg-muted/30 rounded-lg p-3 mt-2 border border-border/30",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-1",children:"Why this step exists"}),(0,s.jsx)("p",{className:"text-sm",children:e.reasoning}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-2 pt-2 border-t border-border/30",children:[(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-medium",children:"Confidence:"})," ","High"]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-medium",children:"Triggered by:"})," ","ICP ",eZ.icpScore," + engagement signals"]})]})]}),"Voice"===e.channel&&(0,s.jsxs)("div",{className:"bg-primary/5 rounded-lg p-4 mt-2 border border-primary/20",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(O.Target,{className:"w-4 h-4 text-primary"}),(0,s.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide",children:"Voice Readiness Check"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2"}),(0,s.jsx)("span",{children:"ICP score threshold met (≥80)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2"}),(0,s.jsx)("span",{children:"Engagement signals met (2+ channels)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2"}),(0,s.jsx)("span",{children:"Guardrails passed"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(E.AlertCircle,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Human approval: Not required"})]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-3 pt-3 border-t border-border/30",children:"Voice is conditional and used only for high-intent leads. This is not a voice-first approach."})]})]})]},a)})})]})})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(L,{className:"w-5 h-5"}),"Conversation & Activity History"]}),(0,s.jsx)(n.CardDescription,{className:"mt-2",children:"Full timeline of messages and AI decisions for auditability"})]}),(0,s.jsx)(h.Tabs,{value:ey,onValueChange:e=>ew(e),children:(0,s.jsxs)(h.TabsList,{children:[(0,s.jsx)(h.TabsTrigger,{value:"executive",className:"text-xs",children:"Executive Summary"}),(0,s.jsx)(h.TabsTrigger,{value:"full",className:"text-xs",children:"Full Audit Trail"})]})})]})}),(0,s.jsxs)(n.CardContent,{children:["completed"===e4&&"full"===ey&&(0,s.jsx)("div",{className:"bg-chart-2/10 rounded-lg p-3 border border-chart-2/30 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2"}),(0,s.jsx)("p",{className:"text-xs font-medium",children:"Timeline locked for audit. All events are timestamped and cannot be modified."})]})}),"active"===e4&&"full"===ey&&(0,s.jsx)("div",{className:"bg-primary/10 rounded-lg p-3 border border-primary/20 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),(0,s.jsx)("p",{className:"text-xs font-medium",children:"Outreach in progress. Events logged in real time as they occur."})]})}),"stopped"===e4&&"full"===ey&&(0,s.jsx)("div",{className:"bg-destructive/10 rounded-lg p-3 border border-destructive/30 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(T.StopCircle,{className:"w-4 h-4 text-destructive"}),(0,s.jsx)("p",{className:"text-xs font-medium",children:"Outreach stopped automatically. Timeline locked for audit."})]})}),"executive"===ey?(0,s.jsx)("div",{className:"space-y-4",children:e3.length>0?e3.map(e=>{var a;return(0,s.jsxs)("div",{className:"flex gap-3 pb-4 border-b last:border-0 last:pb-0",children:[(0,s.jsxs)("div",{className:"p-2 rounded-lg shrink-0 h-fit ".concat("outcome"===e.eventType?"bg-chart-2/10 text-chart-2":"decision"===e.eventType?"bg-primary/10 text-primary":"bg-muted text-foreground"),children:["outcome"===e.eventType&&(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4"}),"decision"===e.eventType&&(0,s.jsx)(O.Target,{className:"w-4 h-4"}),"outreach"===e.eventType&&(null==(a=e.metadata)?void 0:a.channel)==="voice"&&(0,s.jsx)(N.Phone,{className:"w-4 h-4"}),"engagement"===e.eventType&&(0,s.jsx)(b.MessageSquare,{className:"w-4 h-4"})]}),(0,s.jsxs)("div",{className:"flex-1 space-y-2 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsx)("div",{className:"min-w-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:e.badge}),(0,s.jsx)(r.Badge,{variant:"secondary",className:"text-xs",children:e.actor}),(0,s.jsx)("h4",{className:"font-medium text-sm",children:e.title})]})}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground shrink-0",children:e.timestamp})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:e.description})]})]},e.id)}):(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No key events to display yet."})})}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"bg-muted/20 rounded-lg p-2 border border-border/30",children:(0,s.jsx)("p",{className:"text-xs text-center text-muted-foreground",children:"Events shown in chronological order (oldest → newest)"})}),e1.length>0?e1.map(e=>{var a;return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute left-6 top-14 bottom-0 w-px bg-border"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("div",{className:"p-3 rounded-lg shrink-0 border ".concat((e=>{switch(e){case"lifecycle":return"bg-muted/50 border-border text-foreground";case"research":return"bg-primary/5 border-primary/20 text-primary";case"outreach":return"bg-chart-3/5 border-chart-3/20 text-chart-3";case"engagement":return"bg-chart-2/5 border-chart-2/20 text-chart-2";case"decision":return"bg-primary/10 border-primary/30 text-primary";case"guardrail":return"bg-chart-4/5 border-chart-4/20 text-chart-4";case"outcome":return"bg-chart-2/10 border-chart-2/30 text-chart-2";default:return"bg-muted border-border text-foreground"}})(e.eventType)),children:(e=>{switch(e){case"lifecycle":return(0,s.jsx)(B.Database,{className:"w-5 h-5"});case"research":return(0,s.jsx)(z.Search,{className:"w-5 h-5"});case"outreach":return(0,s.jsx)(M,{className:"w-5 h-5"});case"engagement":return(0,s.jsx)(D.Eye,{className:"w-5 h-5"});case"decision":return(0,s.jsx)(O.Target,{className:"w-5 h-5"});case"guardrail":return(0,s.jsx)(y.Shield,{className:"w-5 h-5"});case"outcome":return(0,s.jsx)(w.CheckCircle2,{className:"w-5 h-5"});default:return(0,s.jsx)(L,{className:"w-5 h-5"})}})(e.eventType)}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsxs)("div",{className:"bg-card border rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:e.badge}),(0,s.jsx)(r.Badge,{variant:"AI"===e.actor?"default":"Human"===e.actor?"secondary":"outline",className:"text-xs",children:e.actor})]}),(0,s.jsx)("h4",{className:"font-semibold text-sm",children:e.title})]}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground shrink-0",children:e.timestamp})]}),(0,s.jsx)("p",{className:"text-sm text-foreground leading-relaxed mb-3",children:e.description}),e.metadata&&Object.keys(e.metadata).length>0&&(0,s.jsxs)("div",{className:"bg-muted/30 rounded-lg p-3 border border-border/30",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Event Details"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:Object.entries(e.metadata).map(e=>{let[a,t]=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{className:"text-xs text-muted-foreground capitalize",children:[a.replace(/([A-Z])/g," $1").trim(),":"]})," ",(0,s.jsx)("span",{className:"text-xs font-medium",children:Array.isArray(t)?t.join(", "):"boolean"==typeof t?t?"Yes":"No":String(t)})]},a)})})]}),("outreach"===e.eventType||"engagement"===e.eventType)&&(null==(a=e.metadata)?void 0:a.channel)&&(()=>{let s=eX.find(s=>s.id===e.id);return(null==s?void 0:s.body)||(null==s?void 0:s.scriptUsed)})()&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:()=>(e=>{let s=new Set(eC);s.has(e)?s.delete(e):s.add(e),e_(s)})(e.id),className:"text-xs w-full justify-start",children:[(0,s.jsx)(D.Eye,{className:"w-3 h-3 mr-2"}),eC.has(e.id)?"Hide":"View"," ","Message Content",eC.has(e.id)?(0,s.jsx)(V.ChevronUp,{className:"w-3 h-3 ml-auto"}):(0,s.jsx)(H.ChevronDown,{className:"w-3 h-3 ml-auto"})]}),eC.has(e.id)&&(()=>{let a=eX.find(s=>s.id===e.id);return a?(0,s.jsxs)("div",{className:"mt-3 bg-background rounded-lg p-4 border border-primary/20 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:"email"===a.channel?"Email Content":"linkedin"===a.channel?"LinkedIn Message":"voice"===a.channel?"Voice Call":"Message Content"}),a.aiGenerated&&(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs bg-primary/5 border-primary/20",children:"AI-generated"})]}),a.subject&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Subject"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:a.subject})]}),a.body&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"email"===a.channel?"Email Body":"linkedin"===a.channel?"LinkedIn Message":"Message Content"}),(0,s.jsx)("div",{className:"bg-muted/30 rounded-lg p-4 border border-border/30",children:(0,s.jsx)("pre",{className:"text-sm whitespace-pre-wrap text-foreground leading-relaxed font-sans",children:a.body})})]}),a.scriptUsed&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Voice Call Script (AI-Generated)"}),(0,s.jsx)("div",{className:"bg-muted/30 rounded-lg p-4 border border-border/30",children:(0,s.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap text-foreground leading-relaxed",children:a.scriptUsed})})]}),a.personalizationTokens&&a.personalizationTokens.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Personalization Tokens"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:(a.personalizationTokens||[]).map((e,a)=>(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:e},a))})]}),(0,s.jsx)("div",{className:"pt-2 border-t text-xs text-muted-foreground",children:"This shows the exact content sent to the lead for full transparency and auditability."})]}):null})()]})]})})]})]},e.id)}):(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"p-4 rounded-full bg-muted",children:(0,s.jsx)(F.FileText,{className:"w-8 h-8 text-muted-foreground"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold mb-1",children:"No audit trail available"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"This lead is still in research phase. Full audit trail will be available once outreach begins."})]})]})}),(0,s.jsx)("div",{className:"mt-6 pt-4 border-t border-border/50",children:(0,s.jsx)("p",{className:"text-xs text-center text-muted-foreground",children:"This is an immutable audit log. All events are timestamped and cannot be modified."})})]})]})]}),"active"===e4&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.Card,{className:"border-primary/20 bg-primary/5",children:[(0,s.jsxs)(n.CardHeader,{children:[(0,s.jsx)(n.CardTitle,{children:"Human Controls"}),(0,s.jsx)(n.CardDescription,{children:"Override AI decisions or adjust outreach strategy"})]}),(0,s.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",disabled:eg,onClick:()=>ef("pause"),className:"gap-2",children:[(0,s.jsx)(S,{className:"w-4 h-4"}),"Pause Outreach"]}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",disabled:eg,onClick:()=>ef("voice"),className:"gap-2",children:[(0,s.jsx)(k.PhoneCall,{className:"w-4 h-4"}),"Force Voice Escalation"]}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",disabled:eg,onClick:()=>ef("stop"),className:"gap-2",children:[(0,s.jsx)(T.StopCircle,{className:"w-4 h-4"}),"Stop Outreach"]}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",disabled:eg,className:"gap-2",children:[(0,s.jsx)(A.UserCheck,{className:"w-4 h-4"}),"Send to AE for Review"]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"All control actions are logged for audit purposes and require confirmation."}),eu&&(0,s.jsx)("div",{className:"bg-background rounded-lg p-3 border",children:(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:eu})})]})]}),(0,s.jsxs)(n.Card,{className:"border-chart-4/20 bg-chart-4/5",children:[(0,s.jsxs)(n.CardHeader,{className:"relative pr-20",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(y.Shield,{className:"w-5 h-5 text-chart-4"}),"Outreach Guardrails"]}),(0,s.jsx)(n.CardDescription,{children:"Automated safety controls to maintain quality and compliance"})]}),(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{var e;let s=(null==eT?void 0:eT.guardrails)||e$.guardrails;eM({max_touches:s.max_touches||8,voice_escalation_allowed:null==(e=s.voice_escalation_allowed)||e,voice_escalation_trigger:s.voice_escalation_trigger||"High ICP (≥80) + engagement on 2+ channels",stop_conditions:(s.stop_conditions||[]).join("\n"),compliance_rules:(s.compliance_rules||[]).join("\n")}),eB({open:!0,section:"guardrails"})},className:"absolute top-4 right-4 h-6 px-2 gap-1.5 text-xs",children:[(0,s.jsx)(R.Edit3,{className:"h-3 w-3"}),"Edit"]})]}),(0,s.jsxs)(n.CardContent,{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-foreground uppercase tracking-wide mb-3",children:"Frequency Limits"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-background rounded-lg p-3 border",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Maximum Touches"}),(0,s.jsxs)("p",{className:"text-lg font-semibold",children:[(null==eT||null==(es=eT.guardrails)?void 0:es.max_touches)||e$.guardrails.maxTouches," ","touches"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"After this, outreach stops automatically"})]}),(0,s.jsxs)("div",{className:"bg-background rounded-lg p-3 border",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Voice Escalation"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:(null!=(ed=null==eT||null==(ea=eT.guardrails)?void 0:ea.voice_escalation_allowed)?ed:e$.guardrails.voiceEscalationAllowed)?"Allowed":"Not Allowed"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(null==eT||null==(et=eT.guardrails)?void 0:et.voice_escalation_trigger)||e$.guardrails.voiceEscalationTrigger||"Configured in Agent Instructions"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-foreground uppercase tracking-wide mb-3",children:"AI Auto-Stop Conditions"}),(0,s.jsx)("ul",{className:"space-y-2",children:((null==eT||null==(ei=eT.guardrails)?void 0:ei.stop_conditions)||(null==e$||null==(en=e$.guardrails)?void 0:en.stopConditions)||[]).map((e,a)=>(0,s.jsxs)("li",{className:"flex items-start gap-2 text-sm",children:[(0,s.jsx)(T.StopCircle,{className:"w-4 h-4 text-destructive mt-0.5 shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:e}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:"Jazon will immediately stop outreach when this occurs"})]})]},a))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-foreground uppercase tracking-wide mb-3",children:"Compliance Rules"}),(0,s.jsx)("ul",{className:"space-y-2",children:((null==eT||null==(er=eT.guardrails)?void 0:er.compliance_rules)||["No weekend outreach (respects business hours)","Unsubscribe links included in all emails","GDPR and CAN-SPAM compliant messaging"]).map((e,a)=>(0,s.jsxs)("li",{className:"flex items-start gap-2 text-sm",children:[(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-chart-2 mt-0.5 shrink-0"}),(0,s.jsx)("span",{children:e})]},a))})]})]})]})]}),("active"===e4||"completed"===e4)&&(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{className:"pb-3",children:(0,s.jsx)(n.CardTitle,{className:"text-sm",children:"Channel Mix"})}),(0,s.jsxs)(n.CardContent,{children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Email"}),(0,s.jsx)("span",{className:"font-medium",children:"40%"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"LinkedIn"}),(0,s.jsx)("span",{className:"font-medium",children:"35%"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Voice"}),(0,s.jsx)("span",{className:"font-medium",children:"25%"})]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-3 pt-3 border-t",children:"Optimized based on ICP segment patterns"})]})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{className:"pb-3",children:(0,s.jsx)(n.CardTitle,{className:"text-sm",children:"Response Rate"})}),(0,s.jsxs)(n.CardContent,{children:[(0,s.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-chart-2",children:"32%"}),(0,s.jsx)(I.TrendingUp,{className:"w-4 h-4 text-chart-2"})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Above average for this ICP segment"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-2 pt-2 border-t",children:"Team benchmark: 24% • Segment avg: 28%"})]})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{className:"pb-3",children:(0,s.jsx)(n.CardTitle,{className:"text-sm",children:"Avg. Time to Response"})}),(0,s.jsxs)(n.CardContent,{children:[(0,s.jsx)("div",{className:"text-3xl font-bold",children:"18h"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Median response time"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-2 pt-2 border-t",children:"Faster than enterprise avg: 36h"})]})]})]}),(0,s.jsx)("div",{className:"bg-muted/20 rounded-lg p-3 border border-border/30",children:(0,s.jsx)("p",{className:"text-xs text-center text-muted-foreground",children:"All actions shown are part of a demo environment and do not affect real systems."})})]})]})})}),(0,s.jsx)(o.Dialog,{open:!!ev,onOpenChange:()=>ef(null),children:(0,s.jsxs)(o.DialogContent,{children:[(0,s.jsxs)(o.DialogHeader,{children:[(0,s.jsxs)(o.DialogTitle,{children:["pause"===ev&&"Pause Outreach","voice"===ev&&"Force Voice Escalation","stop"===ev&&"Stop Outreach"]}),(0,s.jsx)(o.DialogDescription,{children:"This action will be logged for audit purposes and require confirmation."})]}),(0,s.jsxs)("div",{className:"py-4",children:[(0,s.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Reason for override (optional):"}),(0,s.jsx)(x.Textarea,{placeholder:"Enter a brief explanation for this manual intervention...",value:eN,onChange:e=>eb(e.target.value),rows:3})]}),(0,s.jsxs)(o.DialogFooter,{children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>ef(null),children:"Cancel"}),(0,s.jsx)(l.Button,{onClick:()=>{if(null==eZ?void 0:eZ._dbLead)e2(ev||"");else{var e,s;e=ev||"",s=({pause:"Outreach paused for this lead. All scheduled actions stopped.",voice:"Voice escalation forced for next touch, aligned with escalation rules.",stop:"Outreach stopped for this lead. Marked for review."})[ev]||"Action completed",ej(!0),ep("Logging ".concat(e," for audit purposes…")),setTimeout(()=>{ep(s),ej(!1),ef(null),eb("")},800)}},children:"Confirm"})]})]})}),(0,s.jsx)(m.Sheet,{open:eH,onOpenChange:eV,children:(0,s.jsxs)(m.SheetContent,{className:"w-[90vw] sm:w-[1200px] max-w-[1400px] flex flex-col overflow-hidden",children:[(0,s.jsxs)(m.SheetHeader,{className:"px-6 pt-6 pb-4 border-b",children:[(0,s.jsxs)(m.SheetTitle,{className:"text-2xl font-semibold flex items-center gap-3",children:[(null==eR?void 0:eR.channel)==="Email"&&(0,s.jsx)("div",{className:"p-2 rounded-lg bg-blue-500/10",children:(0,s.jsx)(f.Mail,{className:"w-5 h-5 text-blue-600"})}),(null==eR?void 0:eR.channel)==="LinkedIn"&&(0,s.jsx)("div",{className:"p-2 rounded-lg bg-indigo-500/10",children:(0,s.jsx)(U,{className:"w-5 h-5 text-indigo-600"})}),(null==eR?void 0:eR.channel)==="Voice"&&(0,s.jsx)("div",{className:"p-2 rounded-lg bg-purple-500/10",children:(0,s.jsx)(N.Phone,{className:"w-5 h-5 text-purple-600"})}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{children:["Step ",null==eR?void 0:eR.step,": ",null==eR?void 0:eR.channel," ","Copy"]}),(0,s.jsx)(r.Badge,{variant:"outline",className:"text-xs",children:eU?"Editing":"AI-Generated"})]})})]}),(0,s.jsx)(m.SheetDescription,{className:"text-sm",children:eU?"Edit the AI-generated copy below. Your changes will override the AI suggestions.":"View the AI-generated copy for this outreach step. Click 'Edit Copy' to make changes."})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:eR&&(0,s.jsxs)("div",{className:"space-y-6",children:[eR._missing&&(0,s.jsxs)(g.Alert,{children:[(0,s.jsx)(E.AlertCircle,{className:"w-4 h-4"}),(0,s.jsx)(g.AlertTitle,{children:"No Draft Available"}),(0,s.jsx)(g.AlertDescription,{children:"No AI draft found for this step yet. Regenerate outreach to generate drafts, or edit and save your own copy."})]}),"Email"===eR.channel&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(p.Label,{className:"text-base font-semibold",children:"Subject Line Options"}),!eU&&(0,s.jsxs)(r.Badge,{variant:"secondary",className:"text-xs",children:[(null==(el=eR.subject_options)?void 0:el.length)||0," ","options"]})]}),eU?(0,s.jsx)(x.Textarea,{value:((null==eQ?void 0:eQ.subject_options)||[]).join("\n"),onChange:e=>eJ({...eQ,subject_options:e.target.value.split("\n").filter(e=>e.trim())}),rows:3,placeholder:"Enter subject lines (one per line)",className:"text-sm resize-none"}):(0,s.jsx)("div",{className:"space-y-2",children:(eR.subject_options||[]).map((e,a)=>(0,s.jsx)(n.Card,{className:"bg-muted/30 border-border/50",children:(0,s.jsx)(n.CardContent,{className:"p-4",children:(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:e})})},a))})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(p.Label,{className:"text-base font-semibold",children:"Email Body"}),eU?(0,s.jsx)(x.Textarea,{value:(null==eQ?void 0:eQ.body)||"",onChange:e=>eJ({...eQ,body:e.target.value}),rows:14,placeholder:"Enter email body",className:"text-sm resize-none"}):(0,s.jsx)(n.Card,{className:"bg-muted/30 border-border/50",children:(0,s.jsx)(n.CardContent,{className:"p-5",children:(0,s.jsx)("pre",{className:"text-sm whitespace-pre-wrap font-sans leading-relaxed text-foreground",children:eR.body})})})]})]}),"LinkedIn"===eR.channel&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(p.Label,{className:"text-base font-semibold",children:"LinkedIn Connection Message"}),eU?(0,s.jsx)(x.Textarea,{value:(null==eQ?void 0:eQ.body)||"",onChange:e=>eJ({...eQ,body:e.target.value}),rows:8,placeholder:"Enter LinkedIn message",className:"text-sm resize-none"}):(0,s.jsx)(n.Card,{className:"bg-muted/30 border-border/50",children:(0,s.jsx)(n.CardContent,{className:"p-5",children:(0,s.jsx)("pre",{className:"text-sm whitespace-pre-wrap font-sans leading-relaxed text-foreground",children:eR.body})})})]}),"Voice"===eR.channel&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(p.Label,{className:"text-base font-semibold",children:"Voice Call Script & Talking Points"}),!eU&&(0,s.jsxs)(r.Badge,{variant:"secondary",className:"text-xs",children:[(null==(ec=eR.talking_points)?void 0:ec.length)||0," points"]})]}),eU?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter each talking point separated by a blank line"}),(0,s.jsx)(x.Textarea,{value:((null==eQ?void 0:eQ.talking_points)||[]).join("\n\n"),onChange:e=>eJ({...eQ,talking_points:e.target.value.split("\n\n").filter(e=>e.trim())}),rows:18,placeholder:"Enter talking points (separate with blank lines)",className:"text-sm resize-none"})]}):(0,s.jsx)(n.Card,{className:"bg-muted/30 border-border/50",children:(0,s.jsx)(n.CardContent,{className:"p-5 space-y-4",children:(eR.talking_points||[]).map((e,a)=>(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-7 h-7 rounded-full bg-primary/10 border border-primary/20 text-primary flex items-center justify-center text-xs font-semibold",children:a+1}),(0,s.jsx)("p",{className:"text-sm flex-1 leading-relaxed text-foreground pt-0.5",children:e})]},a))})})]}),eR.personalization_used&&eR.personalization_used.length>0&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(p.Label,{className:"text-base font-semibold",children:"Personalization Signals Used"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:eR.personalization_used.map((e,a)=>(0,s.jsx)(r.Badge,{variant:"secondary",className:"text-xs py-1.5 px-3",children:e},a))})]}),eR.strategy_alignment&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(p.Label,{className:"text-base font-semibold",children:"Strategy Alignment"}),(0,s.jsx)(n.Card,{className:"bg-primary/5 border-primary/20",children:(0,s.jsx)(n.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(O.Target,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),(0,s.jsx)("p",{className:"text-sm text-foreground leading-relaxed",children:eR.strategy_alignment})]})})})]})]})}),(0,s.jsx)(m.SheetFooter,{className:"px-6 py-4 border-t bg-muted/30",children:eU?(0,s.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>{eG(!1),eJ(eR?{...eR}:null)},className:"flex-1",children:"Cancel"}),(0,s.jsxs)(l.Button,{onClick:async()=>{if((null==eZ?void 0:eZ._dbLead)&&eQ){eF(!0),ep("Saving copy edits...");try{var e;let s=null==eT||null==(e=eT.copy)?void 0:e._id;if(!s)throw Error("Copy run ID not found");let a=(eT.copy.drafts||[]).map(e=>e.step===eQ.step?eQ:e),t=await fetch("/api/leads/".concat(eZ.id,"/outreach/override"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({scope:"outreach_copy",entity_id:s,updates:{drafts:a},path_prefix:"copy_output",reason:"Manual UI edit via Copy Sidebar"})});if(!t.ok){let e=await t.json();throw Error(e.message||"HTTP error! status: ".concat(t.status))}ep("Copy edits saved successfully!"),eG(!1),eV(!1);let i=await fetch("/api/leads/".concat(eZ.id,"/outreach")),n=await i.json();eA(n.data)}catch(e){console.error("Error saving copy edits:",e),ep("Error saving edits: ".concat(e.message))}finally{eF(!1)}}},disabled:eD,className:"flex-1 gap-2",children:[eD?(0,s.jsx)(q.Loader2,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(w.CheckCircle2,{className:"w-4 h-4"}),"Save Changes"]})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>eV(!1),className:"flex-1",children:"Close"}),(0,s.jsxs)(l.Button,{onClick:()=>eG(!0),className:"flex-1 gap-2",children:[(0,s.jsx)(R.Edit3,{className:"w-4 h-4"}),"Edit Copy"]})]})})]})}),(0,s.jsx)(m.Sheet,{open:eP.open,onOpenChange:e=>eB({...eP,open:e}),children:(0,s.jsxs)(m.SheetContent,{className:"w-[600px] sm:w-[800px] overflow-y-auto",children:[(0,s.jsxs)(m.SheetHeader,{className:"px-6",children:[(0,s.jsxs)(m.SheetTitle,{className:"text-xl font-semibold",children:["Edit"," ","strategy"===eP.section?"Outreach Strategy":"copy"===eP.section?"Outreach Copy":"Guardrails"]}),(0,s.jsx)(m.SheetDescription,{className:"text-sm text-muted-foreground",children:"Update the fields below. All fields are prefilled and can be edited."})]}),(0,s.jsxs)("div",{className:"px-6 py-6 space-y-6",children:["guardrails"===eP.section&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{htmlFor:"max_touches",className:"text-sm font-medium",children:"Maximum Touches"}),(0,s.jsx)(u.Input,{id:"max_touches",type:"number",value:ez.max_touches||"",onChange:e=>eM({...ez,max_touches:e.target.value}),placeholder:"e.g., 8",className:"w-full"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"voice_escalation_allowed",checked:ez.voice_escalation_allowed,onChange:e=>eM({...ez,voice_escalation_allowed:e.target.checked}),className:"h-4 w-4"}),(0,s.jsx)(p.Label,{htmlFor:"voice_escalation_allowed",className:"text-sm font-medium",children:"Voice Escalation Allowed"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{htmlFor:"voice_escalation_trigger",className:"text-sm font-medium",children:"Voice Escalation Trigger"}),(0,s.jsx)(x.Textarea,{id:"voice_escalation_trigger",value:ez.voice_escalation_trigger||"",onChange:e=>eM({...ez,voice_escalation_trigger:e.target.value}),rows:3,placeholder:"e.g., High ICP (≥80) + engagement on 2+ channels",className:"w-full resize-none"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{htmlFor:"stop_conditions",className:"text-sm font-medium",children:"AI Auto-Stop Conditions (one per line)"}),(0,s.jsx)(x.Textarea,{id:"stop_conditions",value:ez.stop_conditions||"",onChange:e=>eM({...ez,stop_conditions:e.target.value}),rows:6,placeholder:"Explicit opt-out No engagement after 8 touches",className:"w-full resize-none"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{htmlFor:"compliance_rules",className:"text-sm font-medium",children:"Compliance Rules (one per line)"}),(0,s.jsx)(x.Textarea,{id:"compliance_rules",value:ez.compliance_rules||"",onChange:e=>eM({...ez,compliance_rules:e.target.value}),rows:6,placeholder:"No weekend outreach Unsubscribe links in emails",className:"w-full resize-none"})]})]}),"strategy"===eP.section&&ez.steps&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{htmlFor:"plan_summary",className:"text-sm font-medium",children:"Strategy Summary"}),(0,s.jsx)(x.Textarea,{id:"plan_summary",value:ez.plan_summary||"",onChange:e=>eM({...ez,plan_summary:e.target.value}),rows:2,placeholder:"One-line summary of the outreach strategy",className:"w-full resize-none"})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold mb-4",children:"Strategy Steps"}),(ez.steps||[]).map((e,a)=>(0,s.jsxs)("div",{className:"mb-6 pb-6 border-b last:border-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsxs)(r.Badge,{variant:"outline",className:"text-xs",children:["Step ",e.step]}),(0,s.jsx)(r.Badge,{variant:"secondary",className:"text-xs",children:e.channel})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{className:"text-sm font-medium",children:"Goal"}),(0,s.jsx)(u.Input,{value:e.goal,onChange:e=>{let s=[...ez.steps];s[a].goal=e.target.value,eM({...ez,steps:s})},placeholder:"What this step achieves",className:"w-full"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{className:"text-sm font-medium",children:"Reasoning"}),(0,s.jsx)(x.Textarea,{value:e.reasoning,onChange:e=>{let s=[...ez.steps];s[a].reasoning=e.target.value,eM({...ez,steps:s})},rows:3,placeholder:"Why this step exists",className:"w-full resize-none"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{className:"text-sm font-medium",children:"Delay (hours)"}),(0,s.jsx)(u.Input,{type:"number",value:e.recommended_delay_hours,onChange:e=>{let s=[...ez.steps];s[a].recommended_delay_hours=e.target.value,eM({...ez,steps:s})},placeholder:"48",className:"w-full"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{className:"text-sm font-medium",children:"Send Window"}),(0,s.jsx)(u.Input,{value:e.send_window,onChange:e=>{let s=[...ez.steps];s[a].send_window=e.target.value,eM({...ez,steps:s})},placeholder:"Business hours only",className:"w-full"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{className:"text-sm font-medium",children:"Personalization Signals (one per line)"}),(0,s.jsx)(x.Textarea,{value:e.personalization_signals,onChange:e=>{let s=[...ez.steps];s[a].personalization_signals=e.target.value,eM({...ez,steps:s})},rows:4,placeholder:"Signal 1 Signal 2",className:"w-full resize-none"})]}),"Voice"===e.channel&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.Label,{className:"text-sm font-medium",children:"Gating Conditions (one per line)"}),(0,s.jsx)(x.Textarea,{value:e.gating_conditions,onChange:e=>{let s=[...ez.steps];s[a].gating_conditions=e.target.value,eM({...ez,steps:s})},rows:4,placeholder:"ICP score >= 80 Engagement on 2+ channels",className:"w-full resize-none"})]})]})]},a))]})]})]}),(0,s.jsx)(m.SheetFooter,{className:"px-6 pb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-3 w-full",children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>eB({open:!1,section:null}),disabled:eD,className:"flex-1",children:"Cancel"}),(0,s.jsx)(l.Button,{onClick:async()=>{if((null==eZ?void 0:eZ._dbLead)&&eT){eF(!0);try{if("guardrails"===eP.section)for(let e of[{path:"max_touches",value:parseInt(ez.max_touches)},{path:"voice_escalation_allowed",value:ez.voice_escalation_allowed},{path:"voice_escalation_trigger",value:ez.voice_escalation_trigger},{path:"stop_conditions",value:ez.stop_conditions.split("\n").filter(e=>e.trim())},{path:"compliance_rules",value:ez.compliance_rules.split("\n").filter(e=>e.trim())}])await fetch("/api/leads/".concat(eZ.id,"/outreach/override"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({scope:"outreach_guardrails",entity_id:eT.guardrails._id,path:e.path,value:e.value})});else if("strategy"===eP.section){await fetch("/api/leads/".concat(eZ.id,"/outreach/override"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({scope:"outreach_strategy",entity_id:eT.strategy._id,path:"plan_summary",value:ez.plan_summary})});for(let e=0;e<ez.steps.length;e++){let s=ez.steps[e],a=[{path:"steps[".concat(e,"].goal"),value:s.goal},{path:"steps[".concat(e,"].reasoning"),value:s.reasoning},{path:"steps[".concat(e,"].recommended_delay_hours"),value:parseInt(s.recommended_delay_hours)},{path:"steps[".concat(e,"].send_window"),value:s.send_window},{path:"steps[".concat(e,"].personalization_signals"),value:s.personalization_signals.split("\n").filter(e=>e.trim())}];for(let t of(s.gating_conditions&&a.push({path:"steps[".concat(e,"].gating_conditions"),value:s.gating_conditions.split("\n").filter(e=>e.trim())}),a))await fetch("/api/leads/".concat(eZ.id,"/outreach/override"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({scope:"outreach_strategy",entity_id:eT.strategy._id,path:t.path,value:t.value})})}}let e=await fetch("/api/leads/".concat(eZ.id,"/outreach")),s=await e.json();s.success&&eA(s.data),eB({open:!1,section:null})}catch(e){console.error("Error saving:",e),alert("Failed to save changes")}finally{eF(!1)}}},disabled:eD,className:"flex-1",children:eD?"Saving...":"Save All Changes"})]})})]})})]})}}]);