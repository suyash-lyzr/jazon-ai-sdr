{"version":3,"sources":["turbopack:///[project]/src/app/conversations/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useMemo } from \"react\"\nimport { JazonSidebar } from \"@/components/jazon-sidebar\"\nimport {\n  SidebarInset,\n  SidebarProvider,\n} from \"@/components/ui/sidebar\"\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Button } from \"@/components/ui/button\"\nimport { mockConversations } from \"@/lib/mock-data\"\nimport { useJazonApp } from \"@/context/jazon-app-context\"\nimport { \n  Mail, \n  Phone, \n  MessageSquare, \n  ChevronDown, \n  ChevronUp,\n  Info,\n  CheckCircle2,\n  AlertCircle,\n  Clock,\n  Sparkles,\n  Eye,\n  FileText,\n  Copy\n} from \"lucide-react\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"@/components/ui/collapsible\"\nimport { Alert, AlertDescription } from \"@/components/ui/alert\"\n\ninterface MessageWithTimeBucket {\n  message: typeof mockConversations[string][0]\n  timeBucket: string\n  sortOrder: number\n}\n\nexport default function ConversationsPage() {\n  const { leads } = useJazonApp()\n  const [selectedLeadId, setSelectedLeadId] = useState<string | null>(null)\n  const [expandedMessages, setExpandedMessages] = useState<Set<string>>(new Set())\n  const [expandedAIInsights, setExpandedAIInsights] = useState<Set<string>>(new Set())\n  const [expandedMessageContent, setExpandedMessageContent] = useState<Set<string>>(new Set())\n\n  // Default to first lead with conversations\n  const defaultLead = useMemo(() => {\n    if (leads.length === 0) return null\n    return leads.find(l => mockConversations[l.id]?.length > 0) || leads[0]\n  }, [leads])\n\n  const selectedLead = selectedLeadId\n    ? leads.find(l => l.id === selectedLeadId) || defaultLead\n    : defaultLead\n\n  const conversations = selectedLead ? mockConversations[selectedLead.id] || [] : []\n\n  // Helper: Parse timestamp to date for sorting\n  const parseTimestamp = (timestamp: string): Date => {\n    const now = new Date()\n    if (timestamp.includes(\"hour\")) {\n      const hours = parseInt(timestamp.match(/(\\d+)\\s*hour/)?.[1] || \"0\")\n      return new Date(now.getTime() - hours * 60 * 60 * 1000)\n    }\n    if (timestamp.includes(\"day\")) {\n      const days = parseInt(timestamp.match(/(\\d+)\\s*day/)?.[1] || \"0\")\n      return new Date(now.getTime() - days * 24 * 60 * 60 * 1000)\n    }\n    if (timestamp.includes(\"week\")) {\n      const weeks = parseInt(timestamp.match(/(\\d+)\\s*week/)?.[1] || \"0\")\n      return new Date(now.getTime() - weeks * 7 * 24 * 60 * 60 * 1000)\n    }\n    return now\n  }\n\n  // Helper: Group messages by time bucket\n  const getTimeBucket = (timestamp: string): string => {\n    const date = parseTimestamp(timestamp)\n    const now = new Date()\n    const diffHours = (now.getTime() - date.getTime()) / (1000 * 60 * 60)\n    \n    if (diffHours < 24) return \"Today\"\n    if (diffHours < 48) return \"Yesterday\"\n    if (diffHours < 168) return \"Earlier this week\"\n    return \"Older\"\n  }\n\n  // Sort and group conversations (newest first)\n  const groupedConversations = useMemo(() => {\n    if (conversations.length === 0) return []\n    \n    // Sort by timestamp (newest first)\n    const sorted = [...conversations].sort((a, b) => {\n      const dateA = parseTimestamp(a.timestamp)\n      const dateB = parseTimestamp(b.timestamp)\n      return dateB.getTime() - dateA.getTime()\n    })\n\n    // Group by time bucket\n    const grouped: Record<string, MessageWithTimeBucket[]> = {}\n    sorted.forEach((msg, idx) => {\n      const bucket = getTimeBucket(msg.timestamp)\n      if (!grouped[bucket]) grouped[bucket] = []\n      grouped[bucket].push({\n        message: msg,\n        timeBucket: bucket,\n        sortOrder: idx,\n      })\n    })\n\n    return grouped\n  }, [conversations])\n\n  // Generate AI insights for each message\n  const getAIInsight = (msg: typeof conversations[0]): string[] => {\n    const insights: string[] = []\n    \n    if (msg.channel === \"voice\" && msg.outcome === \"Qualified\") {\n      insights.push(\"Triggered escalation to voice\")\n      insights.push(\"Confirmed technical fit and budget authority\")\n    } else if (msg.direction === \"inbound\" && msg.channel === \"email\") {\n      insights.push(\"Detected buying intent from response\")\n      insights.push(\"Confirmed active evaluation in progress\")\n    } else if (msg.direction === \"outbound\" && msg.channel === \"email\") {\n      if (msg.subject?.toLowerCase().includes(\"qualification\")) {\n        insights.push(\"Initial outreach based on ICP score and triggers\")\n      }\n    } else if (msg.channel === \"linkedin\" && msg.direction === \"outbound\") {\n      insights.push(\"Multi-channel engagement strategy\")\n      insights.push(\"Building rapport before voice escalation\")\n    }\n    \n    if (insights.length === 0) {\n      insights.push(\"Part of multi-channel qualification sequence\")\n    }\n    \n    return insights\n  }\n\n  // Determine conversation status\n  const getConversationStatus = (): {\n    status: string\n    lastSignal: string\n    health: \"positive\" | \"neutral\" | \"stalled\"\n  } => {\n    if (!selectedLead || conversations.length === 0) {\n      return {\n        status: \"No conversations yet\",\n        lastSignal: \"N/A\",\n        health: \"neutral\",\n      }\n    }\n\n    const lastMessage = conversations[0]\n    const hasVoice = conversations.some(m => m.channel === \"voice\")\n    const hasInbound = conversations.some(m => m.direction === \"inbound\")\n\n    let status = \"\"\n    let lastSignal = \"\"\n    let health: \"positive\" | \"neutral\" | \"stalled\" = \"neutral\"\n\n    if (hasVoice && lastMessage.outcome === \"Qualified\") {\n      status = \"Qualified via voice call\"\n      lastSignal = \"Budget confirmed in last call\"\n      health = \"positive\"\n    } else if (hasInbound) {\n      status = \"Engaged, awaiting response\"\n      lastSignal = \"Active evaluation confirmed\"\n      health = \"positive\"\n    } else if (selectedLead.stage === \"Disqualified\") {\n      status = \"Disqualified due to low ICP\"\n      lastSignal = \"ICP score below threshold\"\n      health = \"stalled\"\n    } else {\n      status = \"Outreach in progress\"\n      lastSignal = \"No response yet\"\n      health = \"neutral\"\n    }\n\n    return { status, lastSignal, health }\n  }\n\n  const conversationContext = getConversationStatus()\n\n  const toggleMessage = (messageId: string) => {\n    const newExpanded = new Set(expandedMessages)\n    if (newExpanded.has(messageId)) {\n      newExpanded.delete(messageId)\n    } else {\n      newExpanded.add(messageId)\n    }\n    setExpandedMessages(newExpanded)\n  }\n\n  const toggleAIInsight = (messageId: string) => {\n    const newExpanded = new Set(expandedAIInsights)\n    if (newExpanded.has(messageId)) {\n      newExpanded.delete(messageId)\n    } else {\n      newExpanded.add(messageId)\n    }\n    setExpandedAIInsights(newExpanded)\n  }\n\n  const toggleMessageContent = (messageId: string) => {\n    const newExpanded = new Set(expandedMessageContent)\n    if (newExpanded.has(messageId)) {\n      newExpanded.delete(messageId)\n    } else {\n      newExpanded.add(messageId)\n    }\n    setExpandedMessageContent(newExpanded)\n  }\n\n  // Calculate engagement rate\n  const engagementRate = useMemo(() => {\n    if (conversations.length === 0) return 0\n    const outbound = conversations.filter(c => c.direction === \"outbound\").length\n    const inbound = conversations.filter(c => c.direction === \"inbound\").length\n    return outbound > 0 ? Math.round((inbound / outbound) * 100) : 0\n  }, [conversations])\n\n  return (\n    <SidebarProvider\n      style={\n        {\n          \"--sidebar-width\": \"calc(var(--spacing) * 60)\",\n          \"--header-height\": \"calc(var(--spacing) * 12)\",\n        } as React.CSSProperties\n      }\n    >\n      <JazonSidebar variant=\"inset\" />\n      <SidebarInset>\n        <div className=\"flex flex-1 flex-col\">\n          <div className=\"flex flex-1 flex-col gap-6 p-4 md:gap-8 md:p-6\">\n            {/* Page Header with Lead Selector */}\n            <div className=\"flex items-start justify-between gap-4\">\n              <div className=\"flex flex-col gap-2\">\n                <h1 className=\"text-3xl font-semibold text-foreground\">Conversations</h1>\n                <p className=\"text-sm text-muted-foreground\">\n                  Unified communication view across all channels\n                </p>\n              </div>\n              <div className=\"flex items-center gap-2 min-w-0 max-w-md\">\n                <label className=\"text-xs text-muted-foreground shrink-0\">Lead:</label>\n                <Select\n                  value={selectedLeadId || defaultLead?.id || \"\"}\n                  onValueChange={setSelectedLeadId}\n                >\n                  <SelectTrigger className=\"w-full\">\n                    <SelectValue placeholder=\"Choose a lead\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {leads\n                      .filter(l => mockConversations[l.id]?.length > 0)\n                      .map((lead) => (\n                        <SelectItem key={lead.id} value={lead.id}>\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"font-medium\">{lead.name}</span>\n                            <span className=\"text-muted-foreground\">• {lead.company}</span>\n                            <Badge variant=\"outline\" className=\"ml-auto text-xs\">\n                              ICP {lead.icpScore}\n                            </Badge>\n                            <Badge variant=\"secondary\" className=\"text-xs\">\n                              {lead.stage}\n                            </Badge>\n                          </div>\n                        </SelectItem>\n                      ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            {/* Conversation Context Summary */}\n            {selectedLead && (\n              <div className=\"bg-muted/30 rounded-lg border border-border/50 p-4\">\n                <div className=\"grid grid-cols-4 gap-4\">\n                  <div>\n                    <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-1\">\n                      Current Stage\n                    </p>\n                    <p className=\"text-sm font-medium\">{selectedLead.stage}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-1\">\n                      AI Conversation Status\n                    </p>\n                    <p className=\"text-sm font-medium\">{conversationContext.status}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-1\">\n                      Last Meaningful Signal\n                    </p>\n                    <p className=\"text-sm font-medium\">{conversationContext.lastSignal}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-1\">\n                      Conversation Health\n                    </p>\n                    <Badge\n                      variant={\n                        conversationContext.health === \"positive\"\n                          ? \"default\"\n                          : conversationContext.health === \"stalled\"\n                          ? \"destructive\"\n                          : \"secondary\"\n                      }\n                      className=\"text-xs\"\n                    >\n                      {conversationContext.health === \"positive\"\n                        ? \"Positive\"\n                        : conversationContext.health === \"stalled\"\n                        ? \"Stalled\"\n                        : \"Neutral\"}\n                    </Badge>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Conversation Timeline */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Conversation Timeline</CardTitle>\n                <CardDescription>\n                  Chronological view of all interactions across email, LinkedIn, and voice\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                {/* Read-only Banner */}\n                <Alert className=\"mb-6\">\n                  <Info className=\"h-4 w-4\" />\n                  <AlertDescription className=\"text-xs\">\n                    This timeline shows the exact messages exchanged across channels. Messaging actions and strategy controls are managed in the Outreach Campaign.\n                  </AlertDescription>\n                </Alert>\n\n                {conversations.length === 0 ? (\n                  <div className=\"text-center py-12\">\n                    <p className=\"text-sm text-muted-foreground\">No conversations yet</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-8\">\n                    {Object.entries(groupedConversations).map(([bucket, messages]) => (\n                      <div key={bucket}>\n                        {/* Time Bucket Label */}\n                        <div className=\"flex items-center gap-2 mb-4\">\n                          <div className=\"h-px flex-1 bg-border\" />\n                          <span className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide px-2\">\n                            {bucket}\n                          </span>\n                          <div className=\"h-px flex-1 bg-border\" />\n                        </div>\n\n                        {/* Messages in this bucket */}\n                        <div className=\"space-y-6\">\n                          {messages.map(({ message: msg }, idx) => (\n                            <div key={msg.id} className=\"relative\">\n                              {/* Timeline Line */}\n                              {idx < messages.length - 1 && (\n                                <div className=\"absolute left-[22px] top-12 bottom-0 w-px bg-border\" />\n                              )}\n\n                              <div className=\"flex gap-4\">\n                                {/* Channel Icon */}\n                                <div\n                                  className={`flex-shrink-0 w-11 h-11 rounded-full flex items-center justify-center ${\n                                    msg.channel === \"email\"\n                                      ? \"bg-primary/10 text-primary\"\n                                      : msg.channel === \"voice\"\n                                      ? \"bg-chart-2/10 text-chart-2\"\n                                      : \"bg-chart-3/10 text-chart-3\"\n                                  }`}\n                                >\n                                  {msg.channel === \"email\" && <Mail className=\"w-5 h-5\" />}\n                                  {msg.channel === \"voice\" && <Phone className=\"w-5 h-5\" />}\n                                  {msg.channel === \"linkedin\" && (\n                                    <MessageSquare className=\"w-5 h-5\" />\n                                  )}\n                                </div>\n\n                                {/* Message Content */}\n                                <div className=\"flex-1 space-y-3\">\n                                  <div className=\"flex items-start justify-between\">\n                                    <div className=\"flex items-center gap-2\">\n                                      <Badge variant=\"outline\" className=\"text-xs\">\n                                        {msg.channel}\n                                      </Badge>\n                                      <Badge\n                                        variant={\n                                          msg.direction === \"inbound\" ? \"default\" : \"secondary\"\n                                        }\n                                        className=\"text-xs\"\n                                      >\n                                        {msg.direction}\n                                      </Badge>\n                                    </div>\n                                    <span className=\"text-xs text-muted-foreground\">\n                                      {msg.timestamp}\n                                    </span>\n                                  </div>\n\n                                  {msg.subject && (\n                                    <h4 className=\"font-semibold text-sm\">{msg.subject}</h4>\n                                  )}\n\n                                  {/* Voice Call Summary */}\n                                  {msg.channel === \"voice\" && msg.summary ? (\n                                    <div className=\"border rounded-lg overflow-hidden\">\n                                      <div className=\"bg-muted/50 p-3 space-y-3\">\n                                        <div className=\"flex items-center justify-between\">\n                                          <div className=\"flex items-center gap-4\">\n                                            <div>\n                                              <p className=\"text-xs text-muted-foreground\">\n                                                Duration\n                                              </p>\n                                              <p className=\"text-sm font-medium\">{msg.duration}</p>\n                                            </div>\n                                            <div>\n                                              <p className=\"text-xs text-muted-foreground\">\n                                                Outcome\n                                              </p>\n                                              <Badge variant=\"default\" className=\"text-xs\">\n                                                {msg.outcome}\n                                              </Badge>\n                                            </div>\n                                          </div>\n                                          <Button\n                                            variant=\"ghost\"\n                                            size=\"sm\"\n                                            onClick={() => toggleMessage(msg.id)}\n                                          >\n                                            {expandedMessages.has(msg.id) ? (\n                                              <>\n                                                <ChevronUp className=\"w-4 h-4 mr-1\" />\n                                                Hide Details\n                                              </>\n                                            ) : (\n                                              <>\n                                                <ChevronDown className=\"w-4 h-4 mr-1\" />\n                                                Show Details\n                                              </>\n                                            )}\n                                          </Button>\n                                        </div>\n\n                                        {expandedMessages.has(msg.id) && (\n                                          <div className=\"pt-3 border-t space-y-4\">\n                                            {/* AI Call Summary */}\n                                            <div>\n                                              <div className=\"flex items-center gap-2 mb-2\">\n                                                <Sparkles className=\"w-4 h-4 text-primary\" />\n                                                <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">\n                                                  AI Call Summary\n                                                </p>\n                                              </div>\n                                              <div className=\"space-y-3\">\n                                                <div>\n                                                  <p className=\"text-xs font-medium mb-1\">\n                                                    Key Points Discussed\n                                                  </p>\n                                                  <p className=\"text-sm\">{msg.summary}</p>\n                                                </div>\n                                                {msg.objections && msg.objections.length > 0 && (\n                                                  <div>\n                                                    <p className=\"text-xs font-medium mb-1\">\n                                                      Objections Raised\n                                                    </p>\n                                                    <ul className=\"space-y-1.5\">\n                                                      {msg.objections.map((objection, oidx) => (\n                                                        <li\n                                                          key={oidx}\n                                                          className=\"text-sm flex items-start gap-2\"\n                                                        >\n                                                          <span className=\"text-destructive mt-0.5\">\n                                                            •\n                                                          </span>\n                                                          <span>{objection}</span>\n                                                        </li>\n                                                      ))}\n                                                    </ul>\n                                                  </div>\n                                                )}\n                                                <div>\n                                                  <p className=\"text-xs font-medium mb-1\">\n                                                    Signals Detected\n                                                  </p>\n                                                  <div className=\"flex flex-wrap gap-2\">\n                                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                                      Budget: Confirmed\n                                                    </Badge>\n                                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                                      Authority: Economic buyer\n                                                    </Badge>\n                                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                                      Timeline: Q1\n                                                    </Badge>\n                                                  </div>\n                                                </div>\n                                                <div>\n                                                  <p className=\"text-xs font-medium mb-1\">\n                                                    Impact on Qualification Decision\n                                                  </p>\n                                                  <p className=\"text-sm text-muted-foreground\">\n                                                    Voice call confirmed all BANT criteria. Lead\n                                                    qualified and escalated to AE handoff.\n                                                  </p>\n                                                </div>\n                                              </div>\n                                            </div>\n\n                                            {/* Voice Script Used */}\n                                            {msg.scriptUsed && (\n                                              <div>\n                                                <div className=\"flex items-center gap-2 mb-2\">\n                                                  <FileText className=\"w-4 h-4 text-primary\" />\n                                                  <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">\n                                                    Script Used (AI-Generated)\n                                                  </p>\n                                                </div>\n                                                <div className=\"bg-background rounded-lg p-4 border border-border/30\">\n                                                  <pre className=\"text-xs font-mono whitespace-pre-wrap text-foreground leading-relaxed\">\n{msg.scriptUsed}\n                                                  </pre>\n                                                </div>\n                                              </div>\n                                            )}\n                                          </div>\n                                        )}\n\n                                        {/* AI Insight (collapsed by default) */}\n                                        <Collapsible\n                                          open={expandedAIInsights.has(msg.id)}\n                                          onOpenChange={() => toggleAIInsight(msg.id)}\n                                        >\n                                          <CollapsibleTrigger asChild>\n                                            <Button\n                                              variant=\"ghost\"\n                                              size=\"sm\"\n                                              className=\"w-full justify-start text-xs text-muted-foreground\"\n                                            >\n                                              <Sparkles className=\"w-3 h-3 mr-1\" />\n                                              Why this interaction mattered\n                                              {expandedAIInsights.has(msg.id) ? (\n                                                <ChevronUp className=\"w-3 h-3 ml-auto\" />\n                                              ) : (\n                                                <ChevronDown className=\"w-3 h-3 ml-auto\" />\n                                              )}\n                                            </Button>\n                                          </CollapsibleTrigger>\n                                          <CollapsibleContent>\n                                            <div className=\"pt-2 border-t mt-2\">\n                                              <p className=\"text-xs font-medium text-muted-foreground mb-2\">\n                                                AI Insight\n                                              </p>\n                                              <ul className=\"space-y-1.5\">\n                                                {getAIInsight(msg).map((insight, iidx) => (\n                                                  <li key={iidx} className=\"text-xs flex items-start gap-2\">\n                                                    <span className=\"text-primary mt-0.5\">•</span>\n                                                    <span>{insight}</span>\n                                                  </li>\n                                                ))}\n                                              </ul>\n                                            </div>\n                                          </CollapsibleContent>\n                                        </Collapsible>\n                                      </div>\n                                    </div>\n                                  ) : (\n                                    /* Regular Message */\n                                    <div className=\"space-y-3\">\n                                      <div className=\"bg-muted/30 rounded-lg p-3\">\n                                        <p className=\"text-sm\">{msg.content}</p>\n                                      </div>\n\n                                      {/* View Message Content Button */}\n                                      {msg.body && (\n                                        <Button\n                                          variant=\"ghost\"\n                                          size=\"sm\"\n                                          onClick={() => toggleMessageContent(msg.id)}\n                                          className=\"w-full justify-start text-xs\"\n                                        >\n                                          <Eye className=\"w-3 h-3 mr-2\" />\n                                          {expandedMessageContent.has(msg.id) ? \"Hide\" : \"View\"} Full Message Content\n                                          {expandedMessageContent.has(msg.id) ? (\n                                            <ChevronUp className=\"w-3 h-3 ml-auto\" />\n                                          ) : (\n                                            <ChevronDown className=\"w-3 h-3 ml-auto\" />\n                                          )}\n                                        </Button>\n                                      )}\n\n                                      {/* Expanded Message Content */}\n                                      {expandedMessageContent.has(msg.id) && msg.body && (\n                                        <div className=\"bg-background rounded-lg p-4 border border-border/30 space-y-3\">\n                                          <div className=\"flex items-center justify-between\">\n                                            <div className=\"flex items-center gap-2\">\n                                              <Badge variant=\"outline\" className=\"text-xs\">\n                                                {msg.channel === \"email\" ? \"Email Content\" : msg.channel === \"linkedin\" ? \"LinkedIn Message\" : \"WhatsApp Message\"}\n                                              </Badge>\n                                              <Badge variant=\"secondary\" className=\"text-xs\">\n                                                {msg.direction}\n                                              </Badge>\n                                              {msg.aiGenerated && (\n                                                <Badge variant=\"outline\" className=\"text-xs bg-primary/5 border-primary/20\">\n                                                  AI-generated\n                                                </Badge>\n                                              )}\n                                            </div>\n                                          </div>\n                                          \n                                          {msg.subject && (\n                                            <div>\n                                              <p className=\"text-xs font-medium text-muted-foreground mb-1\">Subject</p>\n                                              <p className=\"text-sm font-medium\">{msg.subject}</p>\n                                            </div>\n                                          )}\n                                          \n                                          <div>\n                                            <p className=\"text-xs font-medium text-muted-foreground mb-2\">Message Body</p>\n                                            <div className=\"bg-muted/30 rounded-lg p-4 border border-border/30\">\n                                              <pre className=\"text-sm whitespace-pre-wrap text-foreground leading-relaxed font-sans\">\n{msg.body}\n                                              </pre>\n                                            </div>\n                                          </div>\n                                          \n                                          {msg.personalizationTokens && msg.personalizationTokens.length > 0 && (\n                                            <div>\n                                              <p className=\"text-xs font-medium text-muted-foreground mb-2\">Personalization Tokens Used</p>\n                                              <div className=\"flex flex-wrap gap-2\">\n                                                {msg.personalizationTokens.map((token, tidx) => (\n                                                  <Badge key={tidx} variant=\"outline\" className=\"text-xs\">\n                                                    {token}\n                                                  </Badge>\n                                                ))}\n                                              </div>\n                                            </div>\n                                          )}\n                                          \n                                          <div className=\"pt-2 border-t text-xs text-muted-foreground\">\n                                            This shows the exact content sent to the lead for full transparency and auditability.\n                                          </div>\n                                        </div>\n                                      )}\n\n                                      {/* AI Insight (collapsed by default) */}\n                                      <Collapsible\n                                        open={expandedAIInsights.has(msg.id)}\n                                        onOpenChange={() => toggleAIInsight(msg.id)}\n                                      >\n                                        <CollapsibleTrigger asChild>\n                                          <Button\n                                            variant=\"ghost\"\n                                            size=\"sm\"\n                                            className=\"w-full justify-start text-xs text-muted-foreground\"\n                                          >\n                                            <Sparkles className=\"w-3 h-3 mr-1\" />\n                                            Why this interaction mattered\n                                            {expandedAIInsights.has(msg.id) ? (\n                                              <ChevronUp className=\"w-3 h-3 ml-auto\" />\n                                            ) : (\n                                              <ChevronDown className=\"w-3 h-3 ml-auto\" />\n                                            )}\n                                          </Button>\n                                        </CollapsibleTrigger>\n                                        <CollapsibleContent>\n                                          <div className=\"pt-2 border-t mt-2\">\n                                            <p className=\"text-xs font-medium text-muted-foreground mb-2\">\n                                              AI Insight\n                                            </p>\n                                            <ul className=\"space-y-1.5\">\n                                              {getAIInsight(msg).map((insight, iidx) => (\n                                                <li\n                                                  key={iidx}\n                                                  className=\"text-xs flex items-start gap-2\"\n                                                >\n                                                  <span className=\"text-primary mt-0.5\">•</span>\n                                                  <span>{insight}</span>\n                                                </li>\n                                              ))}\n                                            </ul>\n                                          </div>\n                                        </CollapsibleContent>\n                                      </Collapsible>\n                                    </div>\n                                  )}\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Communication Stats */}\n            <div className=\"grid gap-4 md:grid-cols-3\">\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-sm\">Channel Breakdown</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Mail className=\"w-4 h-4 text-primary\" />\n                        <span className=\"text-sm\">Email</span>\n                      </div>\n                      <span className=\"text-sm font-medium\">\n                        {conversations.filter((c) => c.channel === \"email\").length}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <MessageSquare className=\"w-4 h-4 text-chart-3\" />\n                        <span className=\"text-sm\">LinkedIn</span>\n                      </div>\n                      <span className=\"text-sm font-medium\">\n                        {conversations.filter((c) => c.channel === \"linkedin\").length}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Phone className=\"w-4 h-4 text-chart-2\" />\n                        <span className=\"text-sm\">Voice</span>\n                      </div>\n                      <span className=\"text-sm font-medium\">\n                        {conversations.filter((c) => c.channel === \"voice\").length}\n                      </span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center gap-2\">\n                    <CardTitle className=\"text-sm\">Engagement Rate</CardTitle>\n                    <TooltipProvider>\n                      <Tooltip>\n                        <TooltipTrigger asChild>\n                          <Info className=\"w-3 h-3 text-muted-foreground cursor-help\" />\n                        </TooltipTrigger>\n                        <TooltipContent className=\"max-w-xs\">\n                          <p className=\"text-xs\">\n                            Engagement counts inbound responses (email replies, LinkedIn messages)\n                            within 7 days of outbound outreach. Voice calls are not included in\n                            this calculation.\n                          </p>\n                        </TooltipContent>\n                      </Tooltip>\n                    </TooltipProvider>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold\">{engagementRate}%</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {conversations.filter((c) => c.direction === \"inbound\").length} responses to{\" \"}\n                    {conversations.filter((c) => c.direction === \"outbound\").length} outreach\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-sm\">Voice Calls</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold text-chart-2\">\n                    {conversations.filter((c) => c.channel === \"voice\").length}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    Strategic qualification calls\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </SidebarInset>\n    </SidebarProvider>\n  )\n}\n"],"names":[],"mappings":"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"}