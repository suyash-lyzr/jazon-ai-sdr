{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/suyashmankar/Desktop/LYZR/Jazon%20-%20AI%20SDR/AI-SDR-APP/AI-SDR/src/models/Company.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from \"mongoose\";\n\nexport interface ICompanySize {\n  employee_count: number;\n  employee_count_confidence: \"High\" | \"Medium\" | \"Low\";\n  annual_revenue_usd: number;\n  revenue_confidence: \"High\" | \"Medium\" | \"Low\";\n  is_public: boolean;\n  ticker: string;\n  exchange: string;\n}\n\nexport interface IHeadquarters {\n  city: string;\n  state_or_region: string;\n  country: string;\n  raw_address: string;\n}\n\nexport interface ICompany extends Document {\n  name: string;\n  domain: string;\n  website_url: string;\n  linkedin_url: string;\n  industry: string;\n  company_size: ICompanySize;\n  headquarters: IHeadquarters;\n  structure: string;\n  sales_motion: string;\n  keywords: string[];\n  confidence: \"High\" | \"Medium\" | \"Low\";\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst CompanySizeSchema = new Schema<ICompanySize>(\n  {\n    employee_count: { type: Number, default: 0 },\n    employee_count_confidence: {\n      type: String,\n      enum: [\"High\", \"Medium\", \"Low\"],\n      default: \"Low\",\n    },\n    annual_revenue_usd: { type: Number, default: 0 },\n    revenue_confidence: {\n      type: String,\n      enum: [\"High\", \"Medium\", \"Low\"],\n      default: \"Low\",\n    },\n    is_public: { type: Boolean, default: false },\n    ticker: { type: String, default: \"\" },\n    exchange: { type: String, default: \"\" },\n  },\n  { _id: false }\n);\n\nconst HeadquartersSchema = new Schema<IHeadquarters>(\n  {\n    city: { type: String, default: \"\" },\n    state_or_region: { type: String, default: \"\" },\n    country: { type: String, default: \"\" },\n    raw_address: { type: String, default: \"\" },\n  },\n  { _id: false }\n);\n\nconst CompanySchema = new Schema<ICompany>(\n  {\n    name: {\n      type: String,\n      required: true,\n      index: true,\n    },\n    domain: {\n      type: String,\n      index: true,\n      sparse: true,\n      unique: true,\n    },\n    website_url: {\n      type: String,\n      default: \"\",\n    },\n    linkedin_url: {\n      type: String,\n      default: \"\",\n    },\n    industry: {\n      type: String,\n      index: true,\n      default: \"\",\n    },\n    company_size: {\n      type: CompanySizeSchema,\n      default: () => ({}),\n    },\n    headquarters: {\n      type: HeadquartersSchema,\n      default: () => ({}),\n    },\n    structure: {\n      type: String,\n      default: \"\",\n    },\n    sales_motion: {\n      type: String,\n      default: \"\",\n    },\n    keywords: {\n      type: [String],\n      default: [],\n    },\n    confidence: {\n      type: String,\n      enum: [\"High\", \"Medium\", \"Low\"],\n      default: \"Low\",\n    },\n  },\n  {\n    timestamps: true,\n    collection: \"companies\",\n  }\n);\n\n// Static method for finding or creating a company\nCompanySchema.statics.findOrCreate = async function (\n  companyData: Partial<ICompany>\n): Promise<ICompany> {\n  const Company = this as Model<ICompany>;\n\n  // Try to find by domain first (most reliable)\n  if (companyData.domain) {\n    const existingByDomain = await Company.findOne({\n      domain: companyData.domain,\n    });\n    if (existingByDomain) {\n      // Update existing company with new data if provided\n      Object.assign(existingByDomain, companyData);\n      await existingByDomain.save();\n      return existingByDomain;\n    }\n  }\n\n  // Try to find by name (case-insensitive)\n  if (companyData.name) {\n    const existingByName = await Company.findOne({\n      name: new RegExp(`^${companyData.name}$`, \"i\"),\n    });\n    if (existingByName) {\n      // Update existing company with new data if provided\n      Object.assign(existingByName, companyData);\n      await existingByName.save();\n      return existingByName;\n    }\n  }\n\n  // Create new company if not found\n  const newCompany = new Company(companyData);\n  await newCompany.save();\n  return newCompany;\n};\n\n// Extend the model interface to include statics\ninterface ICompanyModel extends Model<ICompany> {\n  findOrCreate(companyData: Partial<ICompany>): Promise<ICompany>;\n}\n\nconst Company: ICompanyModel =\n  (mongoose.models.Company as ICompanyModel) ||\n  mongoose.model<ICompany, ICompanyModel>(\"Company\", CompanySchema);\n\nexport default Company;\n\n"],"names":[],"mappings":";;;;AAAA;;AAmCA,MAAM,oBAAoB,IAAI,mHAAM,CAClC;IACE,gBAAgB;QAAE,MAAM;QAAQ,SAAS;IAAE;IAC3C,2BAA2B;QACzB,MAAM;QACN,MAAM;YAAC;YAAQ;YAAU;SAAM;QAC/B,SAAS;IACX;IACA,oBAAoB;QAAE,MAAM;QAAQ,SAAS;IAAE;IAC/C,oBAAoB;QAClB,MAAM;QACN,MAAM;YAAC;YAAQ;YAAU;SAAM;QAC/B,SAAS;IACX;IACA,WAAW;QAAE,MAAM;QAAS,SAAS;IAAM;IAC3C,QAAQ;QAAE,MAAM;QAAQ,SAAS;IAAG;IACpC,UAAU;QAAE,MAAM;QAAQ,SAAS;IAAG;AACxC,GACA;IAAE,KAAK;AAAM;AAGf,MAAM,qBAAqB,IAAI,mHAAM,CACnC;IACE,MAAM;QAAE,MAAM;QAAQ,SAAS;IAAG;IAClC,iBAAiB;QAAE,MAAM;QAAQ,SAAS;IAAG;IAC7C,SAAS;QAAE,MAAM;QAAQ,SAAS;IAAG;IACrC,aAAa;QAAE,MAAM;QAAQ,SAAS;IAAG;AAC3C,GACA;IAAE,KAAK;AAAM;AAGf,MAAM,gBAAgB,IAAI,mHAAM,CAC9B;IACE,MAAM;QACJ,MAAM;QACN,UAAU;QACV,OAAO;IACT;IACA,QAAQ;QACN,MAAM;QACN,OAAO;QACP,QAAQ;QACR,QAAQ;IACV;IACA,aAAa;QACX,MAAM;QACN,SAAS;IACX;IACA,cAAc;QACZ,MAAM;QACN,SAAS;IACX;IACA,UAAU;QACR,MAAM;QACN,OAAO;QACP,SAAS;IACX;IACA,cAAc;QACZ,MAAM;QACN,SAAS,IAAM,CAAC,CAAC,CAAC;IACpB;IACA,cAAc;QACZ,MAAM;QACN,SAAS,IAAM,CAAC,CAAC,CAAC;IACpB;IACA,WAAW;QACT,MAAM;QACN,SAAS;IACX;IACA,cAAc;QACZ,MAAM;QACN,SAAS;IACX;IACA,UAAU;QACR,MAAM;YAAC;SAAO;QACd,SAAS,EAAE;IACb;IACA,YAAY;QACV,MAAM;QACN,MAAM;YAAC;YAAQ;YAAU;SAAM;QAC/B,SAAS;IACX;AACF,GACA;IACE,YAAY;IACZ,YAAY;AACd;AAGF,kDAAkD;AAClD,cAAc,OAAO,CAAC,YAAY,GAAG,eACnC,WAA8B;IAE9B,MAAM,UAAU,IAAI;IAEpB,8CAA8C;IAC9C,IAAI,YAAY,MAAM,EAAE;QACtB,MAAM,mBAAmB,MAAM,QAAQ,OAAO,CAAC;YAC7C,QAAQ,YAAY,MAAM;QAC5B;QACA,IAAI,kBAAkB;YACpB,oDAAoD;YACpD,OAAO,MAAM,CAAC,kBAAkB;YAChC,MAAM,iBAAiB,IAAI;YAC3B,OAAO;QACT;IACF;IAEA,yCAAyC;IACzC,IAAI,YAAY,IAAI,EAAE;QACpB,MAAM,iBAAiB,MAAM,QAAQ,OAAO,CAAC;YAC3C,MAAM,IAAI,OAAO,CAAC,CAAC,EAAE,YAAY,IAAI,CAAC,CAAC,CAAC,EAAE;QAC5C;QACA,IAAI,gBAAgB;YAClB,oDAAoD;YACpD,OAAO,MAAM,CAAC,gBAAgB;YAC9B,MAAM,eAAe,IAAI;YACzB,OAAO;QACT;IACF;IAEA,kCAAkC;IAClC,MAAM,aAAa,IAAI,QAAQ;IAC/B,MAAM,WAAW,IAAI;IACrB,OAAO;AACT;AAOA,MAAM,UACJ,AAAC,oHAAQ,CAAC,MAAM,CAAC,OAAO,IACxB,oHAAQ,CAAC,KAAK,CAA0B,WAAW;uCAEtC","debugId":null}}]
}